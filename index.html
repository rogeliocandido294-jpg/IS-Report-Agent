<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DepEd IS Report Agent</title>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/docx/7.1.0/docx.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

    <style>
        :root { --primary: #1a5276; --secondary: #27ae60; --bg: #f4f7f6; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); padding: 20px; }
        .container { max-width: 850px; margin: auto; background: white; padding: 30px; border-radius: 12px; box-shadow: 0 5px 25px rgba(0,0,0,0.1); }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 20px; }
        label { font-weight: bold; font-size: 0.9rem; color: #2c3e50; }
        input, select, textarea { width: 100%; padding: 12px; border: 1px solid #bdc3c7; border-radius: 6px; margin-top: 5px; }
        .full-width { grid-column: span 2; }
        button { background: var(--secondary); color: white; padding: 18px; border: none; border-radius: 6px; width: 100%; font-size: 1.1rem; font-weight: bold; cursor: pointer; margin-top: 25px; }
        #status { margin-top: 15px; font-weight: bold; text-align: center; color: #1a5276; }
    </style>
</head>
<body>

<div class="container">
    <h1 style="text-align:center;color:var(--primary);">ðŸ“‹ IS Report Agent</h1>

    <div class="grid">
        <div class="full-width">
            <label>Name of School:</label>
            <input type="text" id="schoolName">
        </div>
        <div>
            <label>School Head:</label>
            <input type="text" id="schoolHead">
        </div>
        <div>
            <label>Teacher Name:</label>
            <input type="text" id="teacherName">
        </div>
        <div>
            <label>Subject / Grade Level:</label>
            <input type="text" id="subject">
        </div>
        <div>
            <label>Career Stage:</label>
            <select id="careerStage">
                <option>Proficient (T1â€“T3)</option>
                <option>Highly Proficient (MT1â€“MT4)</option>
            </select>
        </div>
        <div>
            <label>Date of Observation:</label>
            <input type="date" id="obsDate">
        </div>
        <div class="full-width">
            <label>Observation Notes:</label>
            <textarea id="obsNotes" rows="10"></textarea>
        </div>
    </div>

    <button id="genBtn">ðŸ“„ GENERATE WORD REPORT</button>
    <div id="status"></div>
</div>

<script>
document.getElementById('genBtn').onclick = async function () {

    const school = document.getElementById('schoolName').value;
    const head = document.getElementById('schoolHead').value;
    const teacher = document.getElementById('teacherName').value;
    const subject = document.getElementById('subject').value;
    const stage = document.getElementById('careerStage').value;
    const date = document.getElementById('obsDate').value;
    const notes = document.getElementById('obsNotes').value;
    const status = document.getElementById('status');

    if (!teacher || !notes) {
        alert("Teacher Name at Observation Notes ay required.");
        return;
    }

    status.innerHTML = "â³ Gumagawa ng Word report...";

    const content = `
INSTRUCTIONAL SUPERVISION REPORT

School: ${school}
School Head: ${head}
Teacher: ${teacher}
Subject / Grade: ${subject}
Career Stage: ${stage}
Date of Observation: ${date}

OBSERVATION NOTES:
${notes}
`;

    const { Document, Packer, Paragraph, TextRun } = docx;

    const doc = new Document({
        sections: [{
            children: content.split("\n").map(line =>
                new Paragraph({ children: [new TextRun(line)] })
            )
        }]
    });

    const blob = await Packer.toBlob(doc);
    saveAs(blob, `IS_Report_${teacher}.docx`);

    status.innerHTML = "âœ… Word file generated successfully.";
};
</script>

</body>
</html>
